<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Today I counted triangles - Leo Torres</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="../blog/triangles.html">

        <meta name="author" content="Leo Torres" />
        <meta name="keywords" content="python,networks" />
        <meta name="description" content="and I used matrices to do it" />

        <meta property="og:site_name" content="Leo Torres" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Today I counted triangles"/>
        <meta property="og:url" content="../blog/triangles.html"/>
        <meta property="og:description" content="and I used matrices to do it"/>
        <meta property="article:published_time" content="2016-07-29" />
            <meta property="article:section" content="today" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="networks" />
            <meta property="article:author" content="Leo Torres" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="../theme/css/bootstrap.min.css" type="text/css"/>
    <link href="../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="../theme/css/pygments/solarizedlight.css" rel="stylesheet">
    <link rel="stylesheet" href="../theme/css/style.css" type="text/css"/>





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="../" class="navbar-brand">
Leo Torres            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/am.html">Who I am</a></li>
                    <li><a href="/did.html">What I did</a></li>
                    <li><a href="/read.html">What I read</a></li>
                    <li><a href="/do.html">What I do</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<style>
	#banner{
	    background-image:url("../images/banner.png");
	}
</style>

<div id="banner">
	<div class="container">
		<div class="copy">
			<h1>Leo Torres</h1>
				<p class="intro">Grad student, human being</p>
		</div>
	</div>
</div><!-- End Banner -->
<div class="container">
    <div class="row">


        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="../blog/triangles.html"
                       rel="bookmark"
                       title="Permalink to Today I counted triangles">
                        Today I counted triangles
                    </a>
                </h1>
                <h3><p>and I used matrices to do it</p></h3>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-07-29T00:00:00-04:00"> Fri 29 July 2016</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="../tag/python.html">python</a>
        /
	<a href="../tag/networks.html">networks</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Today I wrote the
<a href="http://erdosnet.work/triangles-and-transitivity.html">Triangles and Transitivity</a>
challenge on <a href="http://www.erdosnet.work"><strong>erdos</strong></a>. I'll skip the
introduction and context, although if you are interested in Network
Science, or in knowing if your friends are friends with each other, you
should check it out. Maybe even solve it if you're so inclined.</p>
<p>Here, I'll even wait until you come back.</p>
<p>Done?</p>
<p>OK.</p>
<p>But, really?</p>
<p>OK.</p>
<p>So, the challenge was counting the number of triangles in an undirected
graph, given its adjacency matrix, where a triangle is a triad of nodes all
connected to each other.</p>
<p>My solution basically reduces to this: <span class="math">\(tr(A^3)/6\)</span>, where <span class="math">\(A\)</span> is the
adjacency matrix of the graph and <span class="math">\(tr(A)\)</span> is its trace. And below, the
explanation I wrote.</p>
<p>Consider three nodes <span class="math">\(i\)</span>, <span class="math">\(j\)</span>, and <span class="math">\(k\)</span>. One way to determine if they form a
triangle is the following. Say <span class="math">\(A\)</span> is the adjacency matrix of the graph,
and <span class="math">\(a_{ij}\)</span> is the entry in the <span class="math">\(i\)</span>-th row and <span class="math">\(j\)</span>-th column of <span class="math">\(A\)</span>. If
<span class="math">\(i\)</span> and <span class="math">\(j\)</span> are adjacent, then <span class="math">\(a_{ij}\)</span> is equal to <span class="math">\(1\)</span>. If <span class="math">\(i\)</span>, <span class="math">\(j\)</span>, and
<span class="math">\(k\)</span> form a triangle, we need all of <span class="math">\(a_{ij}\)</span>, <span class="math">\(a_{ik}\)</span>, and <span class="math">\(a_{kj}\)</span> all
equal to <span class="math">\(1\)</span>. This happens if and only if the product <span class="math">\(a_{ij} * a_{ik} *
a_{kj}\)</span> is also equal to <span class="math">\(1\)</span>.  Knowing this, we can count the number of
triangles that include node <span class="math">\(i\)</span> by summing up over all <span class="math">\(j\)</span> and <span class="math">\(k\)</span>:</p>
<div class="math">$$\sum_j \sum_k a_{ij} a_{ik}  a_{kj},$$</div>
<p>which can be rearranged as follows:</p>
<div class="math">$$\sum_j a_{ij} \sum_k a_{ik} a_{kj}.$$</div>
<p>Now, the term inside the second sum is equal to the entry on the <span class="math">\(i\)</span>-th
row, <span class="math">\(j\)</span>-th column of <span class="math">\(A^2\)</span>, the second power of the adjacency matrix
<span class="math">\(A\)</span>. (This fact can be checked in any introductory matrix algebra book.) We
will call it <span class="math">\(b_{ij}\)</span>. Observe that the expression <span class="math">\(a_{ik} a_{kj}\)</span> is equal
to <span class="math">\(1\)</span> if and only if there is a length-2 path from <span class="math">\(i\)</span> to <span class="math">\(j\)</span>, going
through <span class="math">\(k\)</span>. By summing up over <span class="math">\(k\)</span>, we obtain that <span class="math">\(b_{ij} = \sum_k a_{ik}
a_{kj}\)</span> is the total number of length-2 paths starting in <span class="math">\(i\)</span> and ending in
<span class="math">\(j\)</span>. This will be used later.</p>
<p>Now, we have</p>
<div class="math">$$\sum_j a_{ij} * b_{ji}.$$</div>
<p>By the same token as before, this expression is equal to <span class="math">\(c_{ii}\)</span>, the
<span class="math">\(i,i\)</span>-th entry in the <em>third</em> power of <span class="math">\(A\)</span>. (Where we have used the fact
that <span class="math">\(A^2\)</span> is a symmetryc matrix to say that <span class="math">\(b_{ij} = b_{ji}\)</span>.)</p>
<p>In all, we have proved that the <span class="math">\(c_{ii}\)</span> entry in the third power of <span class="math">\(A\)</span>
holds the number of triangles that include node <span class="math">\(i\)</span>. There's still three
more observations we have to make before we are done:</p>
<ol>
<li>
<p>The entry <span class="math">\(c_{ii}\)</span> lies at the diagonal of <span class="math">\(A^3\)</span>, for every <span class="math">\(i\)</span>.</p>
</li>
<li>
<p>Every triangle has three nodes, so if <span class="math">\(i\)</span>, <span class="math">\(j\)</span>, and <span class="math">\(k\)</span> form a triangle
   and we count the triangles involving <span class="math">\(i\)</span>, <span class="math">\(j\)</span>, and <span class="math">\(k\)</span> separately, we
   will be counting the same triangle three times, one for each node.</p>
</li>
<li>
<p>We discussed how the entries of <span class="math">\(A^2\)</span> count the number of length-2 paths
   between pairs of nodes. Similarly, the entries of <span class="math">\(A^3\)</span> hold the number
   of length-3 paths. Thus, <span class="math">\(c_{ii}\)</span> holds the number of length-3 paths
   that start and end in <span class="math">\(i\)</span>. For every triangle, there are two such paths,
   for if <span class="math">\(i\)</span>, <span class="math">\(j\)</span>, and <span class="math">\(k\)</span> are a triangle, then both <span class="math">\(i-j-k-i\)</span> and
   <span class="math">\(i-k-j-i\)</span> are length-3 paths that start and end in <span class="math">\(i\)</span>.</p>
</li>
</ol>
<p>Remark 1 says we need only look at the diagonal of <span class="math">\(A^3\)</span>, while
observations 2 and 3 indicate we are counting every triangle six times in
total. Since the trace of a matrix is just the sum of its diagonal,
<em>voil√†</em>: <span class="math">\(tr(A^3)/6\)</span>.</p>
<p>So there! That's why <span class="math">\(tr(A^3)/6\)</span> counts the number of
triangles.</p>
<p>I though it was nifty.</p>
<p><a href="https://github.com/leotrs/erdos/blob/master/solutions/measures/triangles.py">Here's</a>
my solution in python (with this exact explanation embedded in the
comments).</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">


            <li class="list-group-item"><a href="../do.html"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4></a>
                <ul class="list-group list-inline" id="categories">
                    <li class="list-group-item">
                        <a href="../category/life.html">
life
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="../category/today.html">
today
                        </a>
                    </li>
                </ul>
            </li>

            <li class="list-group-item"><a href="../do.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-4">
                        <a href="../tag/d3.html">
                            d3
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="../tag/draft.html">
                            draft
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="../tag/git.html">
                            git
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="../tag/networks.html">
                            networks
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="../tag/pelican.html">
                            pelican
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="../tag/python.html">
                            python
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="../tag/recurse.html">
                            recurse
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="../tag/rules.html">
                            rules
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="../tag/shell.html">
                            shell
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="../tag/webdev.html">
                            webdev
                        </a>
                    </li>
                </ul>
            </li>


        <hr />
        <li class="list-group-item">
        <div class="rc-scout"></div>
        </li>

    </ul>
</section>            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
        <div class="col-xs-10">
            <div class="rc-scout"></div>
            &copy; 2016 Leo Torres
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="../theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../theme/js/respond.min.js"></script>

    <script src="../theme/js/bodypadding.js"></script>

<script async defer src="https://www.recurse-scout.com/loader.js?t=8ee529bb51c0ad21d73b98a45a13d144"></script>
</body>
</html>